@model dynamic

<form asp-action="UpdateStatusConfirmed" asp-controller="ClassSection" method="post" autocomplete="off" data-ajax="true"
      data-ajax-method="POST" data-ajax-complete="Success">
    <div class="modal-header">
        <h5 class="modal-title" id="statusUpdateModalLabel">Confirm Status Update</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
        <input type="hidden" name="id" value="@Model.SectionId" />
        <input type="hidden" name="status" value="@Model.NewStatus" />
        
        <p id="statusUpdateMessage">@GetStatusMessage(Model.NewStatus)</p>
        <div class="alert alert-info">
            <strong>Section:</strong> <span id="statusUpdateSectionCode">@Model.SectionCode</span><br>
            <strong>Current Status:</strong> <span id="statusUpdateCurrentStatus">@Model.CurrentStatus</span><br>
            <strong>New Status:</strong> <span id="statusUpdateNewStatus">@Model.NewStatus</span>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Update Status</button>
    </div>
</form>

@functions {
    private string GetStatusMessage(string newStatus)
    {
        return newStatus?.ToLower() switch
        {
            "open" => "This will open the section for student enrollment.",
            "running" => "This will start the section and no new enrollments will be allowed.",
            "completed" => "This will mark the section as completed.",
            "cancelled" => "This will cancel the section. This action may affect enrolled students.",
            _ => "Are you sure you want to update the status?"
        };
    }
}
